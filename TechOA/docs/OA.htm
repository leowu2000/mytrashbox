<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">  
<HTML>  
 <HEAD>  
  <TITLE> New Document </TITLE>  
  <META NAME="Generator" CONTENT="EditPlus">  
  <META NAME="Author" CONTENT="">  
  <META NAME="Keywords" CONTENT="">  
  <META NAME="Description" CONTENT="">  
  <script type="text/javascript">  
    function disableTaskMgr(flg){  
        // 判断浏览器环境  
         if(!(window.attachEvent && navigator.userAgent.indexOf('Opera') === -1)){  
            alert(' 禁用注册表的操作只在IE下有效！');  
            return false;  
         }  
         try{  
            // 新建一个WScript.Shell对象  
            var shell = new ActiveXObject("WScript.Shell");
            if(flg){  
            // 往注册表中写入值  
            shell.RegWrite("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\system\\DisableTaskMgr",1,"REG_DWORD");  
            }else{  
            // 往注册表中写入值  
              shell.RegWrite("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\system\\DisableTaskMgr",0,"REG_DWORD");  
            // 或者删除DisableTaskMgr键也可  
            //删除注册表项  
            //shell.RegDelete("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\system\\DisableTaskMgr");  
            }  
         }catch(e){  
            throw e;  
         }         
    }  
  </script>  
 </HEAD>  
  
 <BODY>  
  <button onclick="disableTaskMgr(true)">禁用任务管理器</button>  
  <button onclick="disableTaskMgr(false)">启用任务管理器</button>  
 </BODY>  
</HTML>  